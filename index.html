<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222"/>
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2"/>

<link rel="stylesheet" href="/css/main.css?v=7.1.1"/>


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.1.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Pisces',
    version: '7.1.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="lkgBlog">
<meta property="og:url" content="https://lkggithub.github.io/index.html">
<meta property="og:site_name" content="lkgBlog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="lkg">
<meta name="twitter:card" content="summary">





  
  
  <link rel="canonical" href="https://lkggithub.github.io/"/>



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>lkgBlog </title>
  






  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?f9967890e888a3bfd99eab89c1f47c97";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>







  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<meta name="generator" content="Hexo 5.4.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">lkgBlog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br/>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br/>关于</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br/>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br/>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br/>归档</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lkggithub.github.io/2021/05/09/%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA%E7%9A%84/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lkg"/>
      <meta itemprop="description" content=""/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lkgBlog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2021/05/09/%E7%A3%81%E7%9B%98%E5%88%86%E5%8C%BA%E7%9A%84/" class="post-title-link" itemprop="url">磁盘分区</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2021-05-09 10:26:12 / 修改时间：19:45:38" itemprop="dateCreated datePublished" datetime="2021-05-09T10:26:12+08:00">2021-05-09</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="磁盘分区"><a href="#磁盘分区" class="headerlink" title="磁盘分区"></a>磁盘分区</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l</span><br><span class="line">fdisk /dev/sdb # 开始分区</span><br><span class="line"><span class="meta">#</span><span class="bash"> p   <span class="built_in">print</span> the partition table <span class="comment">#查看当前分区情况</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> n   add a new partition <span class="comment">#添加一个新分区</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> d   delete a partition</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> w   write table to disk and <span class="built_in">exit</span></span></span><br><span class="line"></span><br><span class="line">partprobe # 重新读取分区表信息</span><br><span class="line">mkfs -t ext4 /dev/sdb1 # 格式化</span><br><span class="line">mount /dev/sdb1 /disk1 # 挂载</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改 /etc/fstab 文件挂载</span></span><br><span class="line">blkid /dev/sdb1 # 获取 UUID</span><br><span class="line">vim /etc/fstab </span><br><span class="line">mount -a</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> list block，即用于列出所有可用块设备的信息</span></span><br><span class="line">lsblk</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lkggithub.github.io/2021/03/06/%E7%AE%97%E6%B3%95%E5%9B%BE%E8%A7%A3%E8%AF%BB%E5%90%8E%E6%84%9F/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lkg"/>
      <meta itemprop="description" content=""/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lkgBlog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2021/03/06/%E7%AE%97%E6%B3%95%E5%9B%BE%E8%A7%A3%E8%AF%BB%E5%90%8E%E6%84%9F/" class="post-title-link" itemprop="url">算法图解读后感</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2021-03-06 10:26:12" itemprop="dateCreated datePublished" datetime="2021-03-06T10:26:12+08:00">2021-03-06</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-05-09 19:48:33" itemprop="dateModified" datetime="2021-05-09T19:48:33+08:00">2021-05-09</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="算法图解读后感"><a href="#算法图解读后感" class="headerlink" title="算法图解读后感"></a>算法图解读后感</h1><p>这本书适合对算法感兴趣的入门读者，书中没有太多高深的算法公式，更多是生动形象的趣味图解。如果是一个已经有算法基础的人来看，显然说中说的知识不够深入，但对于想入门或者培养算法兴趣的人来说，这就是一本绝佳的图书。再被读后，我也被深深吸引了。</p>
<p>本来看知乎大神说花一个周末就能读完，但本人花了一周半，不过也是因为工作和生活的原因，并没有进行连续的阅读，只是分散时间阅读。大概合计有效阅读时间应该也在10个小时以内。所以如果用心专心读的话一个周末不成问题。前提是能静下心来去读。</p>
<p>第一次写读后感，希望自己也可以阅读更多书，顺便写一些读后感，算对自己的总结。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lkggithub.github.io/2019/07/24/sql%E5%BF%85%E7%9F%A5%E4%BC%9A%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lkg"/>
      <meta itemprop="description" content=""/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lkgBlog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/24/sql%E5%BF%85%E7%9F%A5%E4%BC%9A%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" class="post-title-link" itemprop="url">sql必知会读书笔记</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-24 11:53:46" itemprop="dateCreated datePublished" datetime="2019-07-24T11:53:46+08:00">2019-07-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-05-09 19:51:10" itemprop="dateModified" datetime="2021-05-09T19:51:10+08:00">2021-05-09</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="sql必知会读书笔记"><a href="#sql必知会读书笔记" class="headerlink" title="sql必知会读书笔记"></a>sql必知会读书笔记</h1><ol>
<li><p>sql是什么</p>
<p>SQL （发音为字母 S-Q-L 或 sequel ）是结构化查询语言（ Structured Query Language ）的缩写。 SQL 是一种专门用来与数据库沟通的语言。</p>
</li>
<li><p>为什么</p>
<p>设计 SQL 的目的是很好地完成一项任务 —— <strong>提供一种从数据库中读写数据的简单有效的方法。</strong></p>
<p>标准 SQL 由 ANSI 标准委员会管理，从而称为 ANSI SQL 。</p>
</li>
</ol>
<h1 id="1-数据库基础"><a href="#1-数据库基础" class="headerlink" title="1. 数据库基础"></a>1. 数据库基础</h1><h2 id="概念："><a href="#概念：" class="headerlink" title="概念："></a>概念：</h2><ol>
<li>数据库（database）<br>保存有组织的数据的容器</li>
<li>表（table）<br>表是一种结构化的文件，可用来存储某种特定类型的数据。</li>
<li>模式（schema）<br>关于数据库和表的布局及特性的信息。这些特性定义了数据在表中如何存储，包含存储什么样的数据，数据如何分解，各部分信息如何命名等信息。</li>
<li>列（ column ）<br>表中的一个字段。所有表都是由一个或多个列组成的。</li>
<li>数据类型<br>所允许的数据的类型。每个表列都有相应的数据类型，它限制（或允许）该列中存储的数据。</li>
</ol>
<p><strong>注意：数据类型兼容</strong><br>数据类型及其名称是 SQL 不兼容的一个主要原因。虽然大多数基本数据类型得到了一致的支持，但许多高级的数据类型却没有。更糟的是，<br>偶然会有相同的数据类型在不同的 DBMS 中具有不同的名称。</p>
<ol start="6">
<li><p>行（row）</p>
<p>表中的一个记录。表中的数据是按行存储的，所保存的每个记录存储在自己的行内。</p>
</li>
<li><p>主键（ primary key ）<br> 一列（或一组列），其值能够唯一标识表中每一行。</p>
<p> <strong>主键的条件：</strong></p>
<blockquote>
<ol>
<li>任意两行都不具有相同的主键值；</li>
<li>每一行都必须具有一个主键值（主键列不允许NULL值）；</li>
<li>主键列中的值不允许修改或更新；</li>
<li>主键值不能重用（如果某行从表中删除，它的主键不能赋给以后的新行）。</li>
</ol>
</blockquote>
</li>
</ol>
<h1 id="2-检索数据"><a href="#2-检索数据" class="headerlink" title="2. 检索数据"></a>2. 检索数据</h1><p>提示：</p>
<blockquote>
<ol>
<li><p><strong>结束 SQL 语句</strong>。多条 SQL 语句必须以分号（；）分隔。多数 DBMS 不需要在单条 SQL 语句后加分号。</p>
</li>
<li><p><strong>SQL 语句不区分大小写</strong>，因此SELECT与select是相同的。</p>
</li>
<li><p><strong>使用空格</strong>。在处理 SQL 语句时，其中所有空格都被忽略。</p>
</li>
<li><p><strong>当心逗号</strong>。在选择多个列时，一定要在列名之间加上逗号，但最后一个列名后不加。如果在最后一个列名后加了逗号，将出现错误</p>
</li>
</ol>
</blockquote>
<p>注释：</p>
<p>单行：“#” 开头</p>
<p>多行：/*      */</p>
<h1 id="3-排序检索数据"><a href="#3-排序检索数据" class="headerlink" title="3. 排序检索数据"></a>3. 排序检索数据</h1><p><strong>ORDER BY 子句的位置</strong><br>在指定一条ORDER BY子句时，应该保证它是SELECT语句中<strong>最后一条子句</strong>。如果它不是最后的子句，将会出现错误消息</p>
<h2 id="按多个列排序"><a href="#按多个列排序" class="headerlink" title="按多个列排序"></a>按多个列排序</h2><p>下面的代码检索 3 个列，并按其中两个列对结果进行排序 —— 首先按价格，然后按名称排序。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_price, prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> prod_price, prod_name;</span><br></pre></td></tr></table></figure>

<h2 id="按列位置排序"><a href="#按列位置排序" class="headerlink" title="按列位置排序"></a>按列位置排序</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_id, prod_price, prod_name</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">2</span>, <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<p>ORDER BY 2，3表示先按prod_price，再按prod_name进行排序。</p>
<h2 id="指定排序方向"><a href="#指定排序方向" class="headerlink" title="指定排序方向"></a>指定排序方向</h2><p>DESC</p>
<p>DESC关键字只应用到直接位于其前面的列名。</p>
<p>警告：在多个列上降序排序<br>如果想在多个列上进行降序排序，必须对每一列指定DESC关键字。</p>
<h1 id="4-过滤数据"><a href="#4-过滤数据" class="headerlink" title="4. 过滤数据"></a>4. 过滤数据</h1><h2 id="WHERE-子句"><a href="#WHERE-子句" class="headerlink" title="WHERE 子句"></a>WHERE 子句</h2><p>在SELECT语句中，数据根据WHERE子句中指定的搜索条件进行过滤。WHERE子句在表名（FROM子句）之后给出，</p>
<p>警告： WHERE 子句的位置<br>在同时使用ORDER BY和WHERE子句时，应该让ORDER BY位于WHERE之后，否则将会产生错误</p>
<h2 id="WHERE-子句操作符"><a href="#WHERE-子句操作符" class="headerlink" title="WHERE 子句操作符"></a>WHERE 子句操作符</h2><table>
<thead>
<tr>
<th>操作符</th>
<th>说 明</th>
</tr>
</thead>
<tbody><tr>
<td>BETWEEN</td>
<td>在指定的两个值之间</td>
</tr>
<tr>
<td>IS NULL</td>
<td>为 NULL 值</td>
</tr>
<tr>
<td>&lt; &gt;</td>
<td>不等于</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> prod_name, prod_price</span><br><span class="line"><span class="keyword">FROM</span> Products</span><br><span class="line"><span class="keyword">WHERE</span> (vend_id <span class="operator">=</span> <span class="string">&#x27;DLL01&#x27;</span> <span class="keyword">OR</span> vend_id <span class="operator">=</span> ‘BRS01’)</span><br><span class="line"><span class="keyword">AND</span> prod_price <span class="operator">&gt;=</span> <span class="number">10</span>;</span><br></pre></td></tr></table></figure>

<p>这条SELECT语句与前一条的唯一差别是，将前两个条件用圆括号括了起来。因为圆括号具有比AND或OR操作符更高的求值顺序，所以 DBMS 首先<br>过滤圆括号内的OR条件。这时， SQL 语句变成了选择由供应商DLL01或BRS01制造的且价格在 10 美元及以上的所有产品，这正是我们希望的结<br>果。</p>
<h3 id="复杂查询"><a href="#复杂查询" class="headerlink" title="复杂查询"></a>复杂查询</h3><p>提示:在WHERE子句中使用圆括号<br>任何时候使用具有AND和OR操作符的WHERE子句，都应该使用圆括号明确地分组操作符。</p>
<h3 id="IN操作符"><a href="#IN操作符" class="headerlink" title="IN操作符"></a>IN操作符</h3><p>为什么要使用IN操作符?其优点为: </p>
<p>在有很多合法选项时，IN操作符的语法更清楚，更直观。 在与其他AND和OR操作符组合使用IN时，求值顺序更容易管理。 IN操作符一般比一组OR操作符执行得更快(在上面这个合法选项很少的例子中，你看不出性能差异)。 IN的最大优点是可以包含其他SELECT语句，能够更动态地建立WHERE子句。 </p>
<h3 id="NOT操作符"><a href="#NOT操作符" class="headerlink" title="NOT操作符"></a>NOT操作符</h3><h1 id="5-用通配符进行过滤"><a href="#5-用通配符进行过滤" class="headerlink" title="5. 用通配符进行过滤"></a>5. 用通配符进行过滤</h1><h2 id="LIKE操作符"><a href="#LIKE操作符" class="headerlink" title="LIKE操作符"></a>LIKE操作符</h2><h3 id="百分号-通配符"><a href="#百分号-通配符" class="headerlink" title="百分号(%)通配符"></a>百分号(%)通配符</h3><p>最常使用的通配符是百分号(%)。在搜索串中，%表示任何字符出现任意次数。</p>
<p><strong>说明:区分大小写</strong><br>根据DBMS的不同及其配置，搜索可以是区分大小写的。如果区分大小写，则’fish%’与Fish bean bag toy就不匹配。</p>
<p><strong>警告:请注意NULL</strong><br>通配符%看起来像是可以匹配任何东西，但有个例外，这就是NULL。子句WHERE prod_name LIKE ‘%’不会匹配产品名称为NULL的行。</p>
<h3 id="下划线-通配符"><a href="#下划线-通配符" class="headerlink" title="下划线(_)通配符"></a>下划线(_)通配符</h3><p>另一个有用的通配符是下划线(_)。下划线的用途与%一样，但它只匹配单个字符，而不是多个字符。</p>
<p>说明:DB2通配符 DB2不支持通配符_。 _</p>
<p>_说明:Access通配符<br> 如果使用的是Microsoft Access，需要使用?而不是_。 </p>
<h3 id="方括号-通配符"><a href="#方括号-通配符" class="headerlink" title="方括号([ ])通配符"></a>方括号([ ])通配符</h3><p>方括号 ([]) 通配符用来指定一个字符集，它必须匹配指定位置(通配符的位置)的一个字符。</p>
<h2 id="使用通配符的技巧"><a href="#使用通配符的技巧" class="headerlink" title="使用通配符的技巧"></a>使用通配符的技巧</h2><ul>
<li><p>不要过度使用通配符。如果其他操作符能达到相同的目的，应该使用其他操作符。</p>
</li>
<li><p>在确实需要使用通配符时，也尽量不要把它们用在搜索模式的开始处。把通配符置于开始处，搜索起来是最慢的。</p>
</li>
<li><p>仔细注意通配符的位置。如果放错地方，可能不会返回想要的数据。</p>
</li>
</ul>
<h1 id="7-计算字段"><a href="#7-计算字段" class="headerlink" title="7.计算字段"></a>7.计算字段</h1><p> CustomersCustomers</p>
<h2 id="拼接字段"><a href="#拼接字段" class="headerlink" title="拼接字段"></a>拼接字段</h2><h2 id="执行算数计算"><a href="#执行算数计算" class="headerlink" title="执行算数计算"></a>执行算数计算</h2><p>加减乘除（+    -    *    /）</p>
<h1 id="8-使用数据处理函数"><a href="#8-使用数据处理函数" class="headerlink" title="8. 使用数据处理函数"></a>8. 使用数据处理函数</h1><p><strong>DBMS 函数的差异</strong></p>
<table>
<thead>
<tr>
<th align="left">函　 数</th>
<th>语　　法</th>
</tr>
</thead>
<tbody><tr>
<td align="left">提取字符串的组成部分</td>
<td>Access 使用 MID() ； DB2 、 Oracle 、 PostgreSQL 和 SQLite 使用 SUBSTR() ； MySQL 和 SQL Server 使用 SUBSTRING()</td>
</tr>
<tr>
<td align="left">数据类型转换</td>
<td>Access 和 Oracle 使用多个函数，每种类型的转换有一个函数； DB2 和 PostgreSQL 使用 CAST() ； MariaDB 、 MySQL 和 SQL Server 使用<br/>CONVERT()</td>
</tr>
<tr>
<td align="left">取当前日期</td>
<td>Access 使用 NOW() ； DB2 和 PostgreSQL 使用 CURRENT_DATE ； MariaDB 和 MySQL 使用 CURDATE() ； Oracle 使用 SYSDATE ； SQL Server<br/>使用 GETDATE() ； SQLite 使用 DATE()</td>
</tr>
</tbody></table>
<h2 id="常用的文本处理函数"><a href="#常用的文本处理函数" class="headerlink" title="常用的文本处理函数"></a>常用的文本处理函数</h2><table>
<thead>
<tr>
<th>函　　数</th>
<th>说　　明</th>
</tr>
</thead>
<tbody><tr>
<td>LEFT() （或使用子字符串函数）</td>
<td>返回字符串左边的字符</td>
</tr>
<tr>
<td>LENGTH() （也使用 DATALENGTH() 或 LEN() ）</td>
<td>返回字符串的长度</td>
</tr>
<tr>
<td>LOWER() （ Access 使用 LCASE() ）</td>
<td>将字符串转换为小写</td>
</tr>
<tr>
<td>LTRIM()</td>
<td>去掉字符串左边的空格</td>
</tr>
<tr>
<td>RIGHT() （或使用子字符串函数）</td>
<td>返回字符串右边的字符</td>
</tr>
<tr>
<td>RTRIM()</td>
<td>去掉字符串右边的空格</td>
</tr>
<tr>
<td>SOUNDEX()</td>
<td>返回字符串的 SOUNDEX 值</td>
</tr>
<tr>
<td>UPPER() （ Access 使用 UCASE() ）</td>
<td>将字符串转换为大写</td>
</tr>
</tbody></table>
<h2 id="数值处理函数"><a href="#数值处理函数" class="headerlink" title="数值处理函数"></a>数值处理函数</h2><table>
<thead>
<tr>
<th>函　　数</th>
<th>说　　明</th>
</tr>
</thead>
<tbody><tr>
<td>ABS()</td>
<td>返回一个数的绝对值</td>
</tr>
<tr>
<td>COS()</td>
<td>返回一个角度的余弦</td>
</tr>
<tr>
<td>EXP()</td>
<td>返回一个数的指数值</td>
</tr>
<tr>
<td>PI()</td>
<td>返回圆周率</td>
</tr>
<tr>
<td>SIN()</td>
<td>返回一个角度的正弦</td>
</tr>
<tr>
<td>SQRT()</td>
<td>返回一个数的平方根</td>
</tr>
<tr>
<td>TAN()</td>
<td>返回一个角度的正切</td>
</tr>
</tbody></table>
<h1 id="9-聚集函数"><a href="#9-聚集函数" class="headerlink" title="9. 聚集函数"></a>9. 聚集函数</h1><p>SQL 聚集函数</p>
<table>
<thead>
<tr>
<th>函　　数</th>
<th>说　　明</th>
</tr>
</thead>
<tbody><tr>
<td>AVG()</td>
<td>返回某列的平均值</td>
</tr>
<tr>
<td>COUNT()</td>
<td>返回某列的行数</td>
</tr>
<tr>
<td>MAX()</td>
<td>返回指定列的最大值</td>
</tr>
<tr>
<td>MIN()</td>
<td>返回某列的最小值</td>
</tr>
<tr>
<td>SUM()</td>
<td>返回某列值之和</td>
</tr>
</tbody></table>
<h2 id="AVG（）"><a href="#AVG（）" class="headerlink" title="AVG（）"></a><strong>AVG（）</strong></h2><p>警告：只用于单个列 </p>
<p><strong>AVG()</strong>只能用来确定特定数值列的平均值，而且列名必须作为函数参数给出。为了获得多个列的平均值，必须使用多个AVG()函数。</p>
<p>AVG()函数忽略列值为NULL的行。</p>
<h2 id="count"><a href="#count" class="headerlink" title="count"></a>count</h2><p>使用COUNT(*)对表中行的数目进行计数，不管表列中包含的是空值（NULL）还是非空值。 </p>
<p>使用COUNT(column)对特定列中具有值的行进行计数，忽略NULL值。</p>
<h2 id="MAX-函数"><a href="#MAX-函数" class="headerlink" title="MAX()函数"></a><strong>MAX()</strong>函数</h2><p>提示：对非数值数据使用MAX() </p>
<p>虽然MAX()一般用来找出最大的数值或日期值，但许多（并非所有）DBMS允许将它用来返回任意列中的最大值，包括返回文本列中的最大 值。在用于文本数据时，MAX()返回按该列排序后的最后一行。</p>
<p>说明：NULL值 </p>
<p>MAX()函数忽略列值为NULL的行。</p>
<h2 id="MIN-函数"><a href="#MIN-函数" class="headerlink" title="MIN()函数"></a><strong>MIN()</strong>函数</h2><h2 id="SUM-函数"><a href="#SUM-函数" class="headerlink" title="SUM()函数"></a><strong>SUM()</strong>函数</h2><p>SUM()用来返回指定列值的和（总计）。</p>
<h1 id="10-分组数据"><a href="#10-分组数据" class="headerlink" title="10. 分组数据"></a>10. 分组数据</h1><p>在使用GROUP BY子句前，需要知道一些重要的规定。 </p>
<ul>
<li><p>GROUP BY子句可以包含任意数目的列，因而可以对分组进行嵌套，更细致地进行数据分组。 </p>
</li>
<li><p>如果在GROUP BY子句中嵌套了分组，数据将在最后指定的分组上进行汇总。换句话说，在建立分组时，指定的所有列都一起计算（所以不能从个别的列取回数据）。 </p>
</li>
<li><p>GROUP BY子句中列出的每一列都必须是检索列或有效的表达式（但不能是聚集函数）。如果在SELECT中使用表达式，则必须在GROUP BY子句中指定相同的表达式。不能使用别名。 </p>
</li>
<li><p>大多数SQL实现不允许GROUP BY列带有长度可变的数据类型（如文本或备注型字段）。 </p>
</li>
<li><p>除聚集计算语句外，SELECT语句中的每一列都必须在GROUP BY子句中给出。 </p>
</li>
<li><p>如果分组列中包含具有NULL值的行，则NULL将作为一个分组返回。如果列中有多行NULL值，它们将分为一组。 </p>
</li>
<li><p>GROUP BY子句必须出现在WHERE子句之后，ORDER BY子句之前。 </p>
</li>
</ul>
<h2 id="过滤分组"><a href="#过滤分组" class="headerlink" title="过滤分组"></a>过滤分组</h2><p>HAVING和WHERE的差别 </p>
<p>WHERE在数据分组前进行过滤，HAVING在数据分组后进行过滤。这是一个重要的区别，WHERE排除的行不包括在分组 中。这可能会改变计算值，从而影响HAVING子句中基于这些值过滤掉的分组。</p>
<p>使用HAVING时应该结合GROUP BY子句，而WHERE子句用于标准的行级过滤。</p>
<h2 id="分组和排序"><a href="#分组和排序" class="headerlink" title="分组和排序"></a>分组和排序</h2><h1 id="18-视图"><a href="#18-视图" class="headerlink" title="18. 视图"></a>18. 视图</h1><p>视图为虚拟的表。它们包含的不是数据而是根据需要检索数据的查询。视图提供了一种封装SELECT语句的层次，可用来简化数据处理，重新格 式化或保护基础数据。</p>
<h2 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h2><p>视图是虚拟的表。与包含数据的表不一样，视图只包含使用时动态检索数据的查询。</p>
<h2 id="为什么"><a href="#为什么" class="headerlink" title="为什么"></a>为什么</h2><ol>
<li><p>重用SQL语句。 </p>
</li>
<li><p>简化复杂的SQL操作。在编写查询后，可以方便地重用它而不必知道其基本查询细节。 </p>
</li>
<li><p>使用表的一部分而不是整个表。 </p>
</li>
<li><p>保护数据。可以授予用户访问表的特定部分的权限，而不是整个表的访问权限。 </p>
</li>
<li><p>更改数据格式和表示。视图可返回与底层表的表示和格式不同的数据。</p>
</li>
</ol>
<p><strong>警告：性能问题</strong></p>
<blockquote>
<p>因为视图不包含数据，所以每次使用视图时，都必须处理查询执行时需要的所有检索。如果你用多个联结和过滤创建了复杂的视图或者嵌套 了视图，性能可能会下降得很厉害。因此，在部署使用了大量视图的应用前，应该进行测试。</p>
</blockquote>
<h2 id="视图的规则和限制"><a href="#视图的规则和限制" class="headerlink" title="视图的规则和限制"></a>视图的规则和限制</h2><ul>
<li><p>与表一样，视图必须唯一命名（不能给视图取与别的视图或表相同的名字）。 </p>
</li>
<li><p>对于可以创建的视图数目没有限制。 </p>
</li>
<li><p>创建视图，必须具有足够的访问权限。这些权限通常由数据库管理人员授予。 </p>
</li>
<li><p>视图可以嵌套，即可以利用从其他视图中检索数据的查询来构造视图。所允许的嵌套层数在不同的DBMS中有所不同（嵌套视图可能会严 </p>
</li>
<li><p>重降低查询的性能，因此在产品环境中使用之前，应该对其进行全面测试）。 </p>
</li>
<li><p>许多DBMS禁止在视图查询中使用ORDER BY子句。 </p>
</li>
<li><p>有些DBMS要求对返回的所有列进行命名，如果列是计算字段，则需要使用别名（关于列别名的更多信息，请参阅第7课）。 </p>
</li>
<li><p>视图不能索引，也不能有关联的触发器或默认值。 </p>
</li>
<li><p>有些DBMS把视图作为只读的查询，这表示可以从视图检索数据，但不能将数据写回底层表。详情请参阅具体的DBMS文档。 </p>
</li>
<li><p>有些DBMS允许创建这样的视图，它不能进行导致行不再属于视图的插入或更新。例如有一个视图，只检索带有电子邮件地址的顾客。如 </p>
</li>
<li><p>果更新某个顾客，删除他的电子邮件地址，将使该顾客不再属于视图。这是默认行为，而且是允许的，但有的DBMS可能会防止这种情况 发生。</p>
</li>
</ul>
<h2 id="视图的使用"><a href="#视图的使用" class="headerlink" title="视图的使用"></a>视图的使用</h2><h3 id="创建和删除"><a href="#创建和删除" class="headerlink" title="创建和删除"></a>创建和删除</h3><p>视图用CREATE VIEW语句来创建</p>
<p>删除视图，可以使用DROP语句，其语法为DROP VIEW viewname。覆盖（或更新）视图，必须先删除它，然后再重新创建。</p>
<h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><ol>
<li><p>利用视图简化复杂的联结</p>
</li>
<li><p>用视图重新格式化检索出的数据</p>
</li>
<li><p>用视图过滤不想要的数据</p>
</li>
<li><p>使用视图与计算字段</p>
</li>
</ol>
<h1 id="19-存储过程"><a href="#19-存储过程" class="headerlink" title="19. 存储过程"></a>19. 存储过程</h1><p>可以创建存储过程。简单来说，存储过程就是为以后使用而保存的一条或多条SQL语句。可将其视为批文件，虽然它们的作用不仅限于批处理。</p>
<h2 id="是什么-1"><a href="#是什么-1" class="headerlink" title="是什么"></a>是什么</h2><h2 id="为什么-1"><a href="#为什么-1" class="headerlink" title="为什么"></a>为什么</h2><ul>
<li><p>通过把处理封装在一个易用的单元中，可以简化复杂的操作（如前面例子所述）。 </p>
</li>
<li><p>由于不要求反复建立一系列处理步骤，因而保证了数据的一致性。如果所有开发人员和应用程序都使用同一存储过程，则所使用的代码都是相同的。 </p>
</li>
<li><p>这一点的延伸就是防止错误。需要执行的步骤越多，出错的可能性就越大。防止错误保证了数据的一致性。 </p>
</li>
<li><p>简化对变动的管理。如果表名、列名或业务逻辑（或别的内容）有变化，那么只需要更改存储过程的代码。使用它的人员甚至不需要知道 这些变化。 </p>
</li>
<li><p>这一点的延伸就是安全性。通过存储过程限制对基础数据的访问，减少了数据讹误（无意识的或别的原因所导致的数据讹误）的机会。 因为存储过程通常以编译过的形式存储，所以DBMS处理命令的工作较少，提高了性能。 </p>
</li>
<li><p>存在一些只能用在单个请求中的SQL元素和特性，存储过程可以使用它们来编写功能更强更灵活的代码。 </p>
</li>
</ul>
<p>换句话说，使用存储过程有三个主要的好处，即简单、安全、高性能。显然，它们都很重要。不过，在将SQL代码转换为存储过程前，也必须 </p>
<p>知道它的一些缺陷。 </p>
<ul>
<li><p>不同DBMS中的存储过程语法有所不同。事实上，编写真正的可移植存储过程几乎是不可能的。不过，存储过程的自我调用（名字以及数 据如何传递）可以相对保持可移植。因此，如果需要移植到别的DBMS，至少客户端应用代码不需要变动。 </p>
</li>
<li><p>一般来说，编写存储过程比编写基本SQL语句复杂，需要更高的技能，更丰富的经验。因此，许多数据库管理员把限制存储过程的创建作 </p>
</li>
</ul>
<p>为安全措施（主要受上一条缺陷的影响）。</p>
<h2 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create procedure productpricing()</span><br><span class="line">BEGIN</span><br><span class="line">    SELECT AVG(prod_price) AS priceaverage</span><br><span class="line">    FROM products;</span><br><span class="line">END</span><br></pre></td></tr></table></figure>

<p>用CREATE PROCEDURE productpricing()语句定义。如果存储过程接受参数，它们将在()中列举出来。存储过程的代码位于BEGIN和END语句内，</p>
<p><strong>mysql命令行客户机的分隔符</strong></p>
<p>DELIMITER //告诉命令行实用程序使用//作为新的语句结束分隔符，</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CALL productpricing()</span><br></pre></td></tr></table></figure>

<h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE productpricing;</span><br><span class="line">DROP PROCEDURE productpricing IF EXISTS;</span><br></pre></td></tr></table></figure>

<h2 id="使用参数"><a href="#使用参数" class="headerlink" title="使用参数"></a>使用参数</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">create procedure productpricing(</span><br><span class="line">    OUT p1 DECIMAL(8, 2),</span><br><span class="line">    OUT ph DECIMAL(8, 2),</span><br><span class="line">    OUT pa DECIMAL(8, 2)</span><br><span class="line">)</span><br><span class="line">BEGIN</span><br><span class="line">    SELECT MIN(prod_price) INTO p1 FROM products;</span><br><span class="line">    SELECT MAX(prod_price) INTO ph FROM products;</span><br><span class="line">    SELECT AVG(prod_price) INTO pa FROM products</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p>每个参数必须具有指定的类型，这里使用十进制值(DECIMAL 关键字)。关键字OUT指出相应的参数用来从存储过程传出一个值（返回给调用者）。MySQL支持IN（传递给存储过程）、OUT（从存储过程传出，如这里所用）和INOUT（对存储过程传入和传出）类型的参数。</p>
<h3 id="使用-1"><a href="#使用-1" class="headerlink" title="使用"></a>使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CALL productpricing(@procelow, @pricehigh, @priceAverage);</span><br><span class="line">SELECT @procelow;</span><br></pre></td></tr></table></figure>

<p><strong>变量名:</strong> 所有MySQL变量都必须以@开始。</p>
<h2 id="建立智能存储过程"><a href="#建立智能存储过程" class="headerlink" title="建立智能存储过程"></a>建立智能存储过程</h2><p>只有在存储过程内包含业务规则和智能处理时，它们的威力才真正显现出来。</p>
<p>用DECLARE语句定义了两个局部变量。DECLARE要求指定变量名和数据类型，它也支持可选的默认值.</p>
<p><strong>COMMENT关键字</strong> 本例子中的存储过程在CREATE PROCEDURE语<br>句中包含了一个COMMENT值。它不是必需的，但如果给出，将<br>在SHOW PROCEDURE STATUS的结果中显示。</p>
<h2 id="检查存储过程"><a href="#检查存储过程" class="headerlink" title="检查存储过程"></a>检查存储过程</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 显示用来创建一个存储过程的CREATE语句</span><br><span class="line">SHOW CREATE PROCEDURE ordertotal;</span><br><span class="line"># 了获得包括何时、由谁创建等详细信息的存储过程列表</span><br><span class="line">SHOW STATUS PROCEDURE ordertotal;</span><br></pre></td></tr></table></figure>

<h1 id="20-管理事务处理"><a href="#20-管理事务处理" class="headerlink" title="20. 管理事务处理"></a>20. 管理事务处理</h1><h2 id="为什么-2"><a href="#为什么-2" class="headerlink" title="为什么"></a>为什么</h2><p>使用事务处理（transaction processing），通过确保成批的SQL操作要么完全执行，要么完全不执行，来维护数据库的完整</p>
<ul>
<li>事务（transaction）指一组SQL语句；</li>
<li>回退（rollback）指撤销指定SQL语句的过程；</li>
<li>提交（commit）指将未存储的SQL语句结果写入数据库表；</li>
<li>保留点（savepoint）指事务处理中设置的临时占位符（placeholder），可以对它发布回退（与回退整个事务处理不同）</li>
</ul>
<h2 id="控制事务处理"><a href="#控制事务处理" class="headerlink" title="控制事务处理"></a>控制事务处理</h2><p>管理事务处理的关键在于将SQL语句组分解为逻辑块，并明确规定数据何时应该回退，何时不应该回退。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 开始事务</span><br><span class="line">start transaction</span><br><span class="line"></span><br><span class="line"># 回退</span><br><span class="line">ROLLBACK</span><br><span class="line"></span><br><span class="line"># 提交</span><br><span class="line">COMMIT</span><br><span class="line"></span><br><span class="line"># 保留点, 部分回退</span><br><span class="line">SAVEPOINT point1;</span><br><span class="line">ROLLBACK TO point1</span><br></pre></td></tr></table></figure>

<p>ROLLBACK命令用来回退（撤销）MySQL语句</p>
<p>ROLLBACK** 只能在一个事务处理内使用（在执行一条STARTTRANSACTION命令之后）。</p>
<p>一般的MySQL语句都是直接针对数据库表执行和编写的。这就是所谓的隐含提交（implicit commit），即提交（写或保存）操作是自动进行的。</p>
<p>​    但是，在事务处理块中，提交不会隐含地进行。为进行明确的提交，使用COMMIT语句.</p>
<p><strong>隐含事务关闭 :</strong>当COMMIT或ROLLBACK语句执行后，事务会自动关闭（将来的更改会隐含提交）</p>
<p>保留点越多越好可以在SQL代码中设置任意多的保留点，越多越好。为什么呢？因为保留点越多，你就越能灵活地进行回退。</p>
<h1 id="21-使用游标"><a href="#21-使用游标" class="headerlink" title="21. 使用游标"></a>21. 使用游标</h1><p><strong>结果集（result set）</strong>SQL查询所检索出的结果。</p>
<h2 id="为什么-3"><a href="#为什么-3" class="headerlink" title="为什么"></a>为什么</h2><p>有时，需要在检索出来的行中前进或后退一行或多行，这就是游标的用途所在。</p>
<h2 id="是什么-2"><a href="#是什么-2" class="headerlink" title="是什么"></a>是什么</h2><p>游标（cursor）是一个存储在DBMS服务器上的数据库查询， 它不是一条SELECT语句，而是被该语句检索出来的结果集。</p>
<h2 id="选项和特性"><a href="#选项和特性" class="headerlink" title="选项和特性"></a>选项和特性</h2><ul>
<li><p>能够标记游标为只读，使数据能读取，但不能更新和删除。 </p>
</li>
<li><p>能控制可以执行的定向操作（向前、向后、第一、最后、绝对位置、相对位置等）。 </p>
</li>
<li><p>能标记某些列为可编辑的，某些列为不可编辑的。 </p>
</li>
<li><p>规定范围，使游标对创建它的特定请求（如存储过程）或对所有请求可访问。 </p>
</li>
<li><p>指示DBMS对检索出的数据（而不是指出表中活动数据）进行复制，使数据在游标打开和访问期间不变化。</p>
</li>
</ul>
<p><strong>说明：游标与基于Web的应用</strong></p>
<h2 id="使用游标"><a href="#使用游标" class="headerlink" title="使用游标"></a>使用游标</h2><p><strong>步骤：</strong></p>
<ol>
<li><p>在使用游标前，必须声明（定义）它。这个过程实际上没有检索数据，它只是定义要使用的SELECT语句和游标选项。 </p>
</li>
<li><p>一旦声明，就必须打开游标以供使用。这个过程用前面定义的SELECT语句把数据实际检索出来。 </p>
</li>
<li><p>对于填有数据的游标，根据需要取出（检索）各行。 </p>
</li>
<li><p>在结束游标使用时，必须关闭游标，可能的话，释放游标（有赖于具体的DBMS）。</p>
</li>
</ol>
<p>使用DECLARE语句创建游标</p>
<p><strong>创建</strong></p>
<p><strong>使用</strong></p>
<h1 id="22-高级SQL特性"><a href="#22-高级SQL特性" class="headerlink" title="22. 高级SQL特性"></a>22. 高级SQL特性</h1><h2 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h2><h3 id="是什么-3"><a href="#是什么-3" class="headerlink" title="是什么"></a>是什么</h3><p><strong>约束（constraint）</strong> 管理如何插入或处理数据库数据的规则。</p>
<p>包括：主键、外键、唯一约束、检查约束</p>
<h3 id="主键"><a href="#主键" class="headerlink" title="主键"></a>主键</h3><p>满足条件：</p>
<ul>
<li><p>任意两行的主键值都不相同。 </p>
</li>
<li><p>每行都具有一个主键值（即列中不允许NULL值）。 </p>
</li>
<li><p>包含主键值的列从不修改或更新。（大多数DBMS不允许这么做，但如果你使用的DBMS允许这样做，好吧，千万别！） </p>
</li>
<li><p>主键值不能重用。如果从表中删除某一行，其主键值不分配给新行。</p>
</li>
</ul>
<p>指定列为主键： <strong>PRIMARY KEY</strong></p>
<h3 id="外键"><a href="#外键" class="headerlink" title="外键"></a>外键</h3><p>外键是表中的一列，其值必须列在另一表的主键中。外键是保证引用完整性的极其重要部分。</p>
<p>外键有助防止意外删除</p>
<h3 id="唯一约束"><a href="#唯一约束" class="headerlink" title="唯一约束"></a>唯一约束</h3><p>主键和唯一约束区别：</p>
<ul>
<li>表可包含多个唯一约束，但每个表只允许一个主唯一约束列可包含NULL值。</li>
<li>唯一约束列可修改或更新。</li>
<li>唯一约束列的值可重复使用。与</li>
<li>主键不一样，唯一约束不能用来定义外键。</li>
</ul>
<h3 id="检查约束"><a href="#检查约束" class="headerlink" title="检查约束"></a>检查约束</h3><p>检查约束用来保证一列（或一组列）中的数据满足一组指定的条件。检查约束的常见用途有以下几点。 </p>
<ul>
<li><p>检查最小或最大值。例如，防止0个物品的订单（即使0是合法的数）。 </p>
</li>
<li><p>指定范围。例如，保证发货日期大于等于今天的日期，但不超过今天起一年后的日期。 </p>
</li>
<li><p>只允许特定的值。例如，在性别字段中只允许M或F。</p>
</li>
</ul>
<h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><h2 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h2><p><strong>是什么：</strong>触发器是特殊的存储过程，它在特定的数据库活动发生时自动执行。</p>
<p>一般来说，约束的处理比触发器快，因此在可能的时候，应该尽量使用约束。</p>
<h2 id="数据库安全"><a href="#数据库安全" class="headerlink" title="数据库安全"></a>数据库安全</h2><ul>
<li><p>对数据库管理功能（创建表、更改或删除已存在的表等）的访问； </p>
</li>
<li><p>对特定数据库或表的访问； </p>
</li>
<li><p>访问的类型（只读、对特定列的访问等）； </p>
</li>
<li><p>仅通过视图或存储过程对表进行访问； </p>
</li>
<li><p>创建多层次的安全措施，从而允许多种基于登录的访问和控制； </p>
</li>
<li><p>限制管理用户账号的能力。</p>
</li>
</ul>
<h1 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h1><table>
<thead>
<tr>
<th>关键字</th>
<th>作用</th>
<th>附加说明</th>
</tr>
</thead>
<tbody><tr>
<td>SELECT</td>
<td>要返回的列或表达式</td>
<td></td>
</tr>
<tr>
<td>FROM</td>
<td>从中检索数据的表</td>
<td></td>
</tr>
<tr>
<td>WHERE</td>
<td>指定搜索条件进行过滤（行级过滤）</td>
<td>范围值检查：BETWEEN  xx AND xx<br/>指定条件范围：IN(xx, xx)<br/>否定其后条件：NOT</td>
</tr>
<tr>
<td>GROUP BY</td>
<td>分组</td>
<td>组级过滤：HAVING</td>
</tr>
<tr>
<td>ORDER BY</td>
<td>输出排序顺序</td>
<td>降序：DESC （DESCENDING）<br/>升序（默认）：ASC（ASCENDING）</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>DISTINCT    distinct</td>
<td></td>
<td></td>
</tr>
<tr>
<td>IS NULL</td>
<td>非空检查</td>
<td></td>
</tr>
<tr>
<td>AND 、OR</td>
<td>逻辑操作符</td>
<td></td>
</tr>
<tr>
<td>LIKE</td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody></table>
<ol>
<li><p><strong>distinct</strong></p>
<p>它指示数据库只返回不同的值。</p>
<blockquote>
<p>eg：SELECT DISTINCT vend_id FROM Products;</p>
</blockquote>
<p><strong>警告：不能部分使用 DISTINCT</strong><br>DISTINCT关键字作用于所有的列，不仅仅是跟在其后的那一列。例如，你指定SELECT DISTINCT vend_id, prod_price，除非指定的两列完<br>全相同，否则所有的行都会被检索出来。</p>
</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lkggithub.github.io/2019/07/18/redis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lkg"/>
      <meta itemprop="description" content=""/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lkgBlog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/18/redis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/" class="post-title-link" itemprop="url">redis配置文件</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-18 14:07:36" itemprop="dateCreated datePublished" datetime="2019-07-18T14:07:36+08:00">2019-07-18</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-03-06 14:39:57" itemprop="dateModified" datetime="2021-03-06T14:39:57+08:00">2021-03-06</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h1><p>源于redis版本 <a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/antirez/redis/3.2/redis.conf">3.2.1</a>，可能和最新版本略有差异。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######################## 引用 #########################</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 不同redis server可以使用同一个模版配置作为主配置，并引用其它配置文件用于本server的个性<span class="comment"># 化设置</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> include并不会被CONFIG REWRITE命令覆盖。但是主配置文件的选项会被覆盖。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 想故意覆盖主配置的话就把include放文件前面，否则最好放末尾</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> include /path/to/local.conf</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> include /path/to/other.conf</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######################## 网络 #########################</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 不指定<span class="built_in">bind</span>的话redis将会监听所有网络接口。这个配置是肯定需要指定的。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Examples:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">bind</span> 192.168.1.100 10.0.0.1</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">bind</span> 127.0.0.1 ::1</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 下面这个配置是只允许本地客户端访问。</span></span><br><span class="line">bind 127.0.0.1</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 是否开启保护模式。默认开启，如果没有设置<span class="built_in">bind</span>项的ip和redis密码的话，服务将只允许本地访 问。</span></span><br><span class="line">protected-mode yes</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 端口设置，默认为 6379</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果port设置为0 redis将不会监听tcp socket</span></span><br><span class="line">port 6379</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在高并发环境下需要一个高backlog值来避免慢客户端连接问题。注意Linux内核默默将这个值减小到/proc/sys/net/core/somaxconn的值，所以需要确认增大somaxconn和tcp_max_syn_backlog 两个值来达到需要的效果。</span></span><br><span class="line">tcp-backlog 511</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定用来监听Unix套套接字的路径。没有默认值，没有指定的情况下Redis不会监听Unix socket</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> unixsocket /tmp/redis.sock</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> unixsocketperm 700</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 客户端空闲多少秒后关闭连接（0为不关闭）timeout 0<span class="comment"># tcp-keepalive设置。如果非零，则设置SO_KEEPALIVE选项来向空闲连接的客户端发送ACK，用途如下：</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1）能够检测无响应的对端</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2）让该连接中间的网络设备知道这个连接还存活</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在Linux上，这个指定的值(单位秒)就是发送ACK的时间间隔。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意：要关闭这个连接需要两倍的这个时间值。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在其他内核上这个时间间隔由内核配置决定<span class="comment"># 从redis3.2.1开始默认值为300秒</span></span></span><br><span class="line">tcp-keepalive 300</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######################## 通用 #########################</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 是否将Redis作为守护进程运行。如果需要的话配置成<span class="string">&#x27;yes&#x27;</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意配置成守护进程后Redis会将进程号写入文件/var/run/redis.pid</span></span><br><span class="line">daemonize no</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 是否通过upstart或systemd管理守护进程。默认no没有服务监控，其它选项有upstart, systemd, auto</span></span><br><span class="line">supervised no</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> pid文件在redis启动时创建，退出时删除。最佳实践为配置该项。</span></span><br><span class="line">pidfile /var/run/redis_6379.pid</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置日志级别。选项有debug, verbose, notice, warning</span></span><br><span class="line">loglevel notice</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 日志名称。空字符串表示标准输出。注意如果redis配置为后台进程，标准输出中信息会发送到/dev/null</span></span><br><span class="line">logfile &quot;&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 是否启动系统日志记录。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> syslog-enabled no</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定系统日志身份。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> syslog-ident redis</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定syslog设备。必须是user或LOCAL0 ~ LOCAL7之一。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> syslog-facility local0</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置数据库个数。默认数据库是 DB 0</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以通过SELECT <span class="built_in">where</span> dbid is a number between 0 and <span class="string">&#x27;databases&#x27;</span>-1为每个连接使用不同的数据库。</span></span><br><span class="line">databases 16</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######################## 备份  #########################</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 持久化设置:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 下面的例子将会进行把数据写入磁盘的操作:</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  900秒（15分钟）之后，且至少1次变更</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  300秒（5分钟）之后，且至少10次变更</span></span><br><span class="line"><span class="meta">#</span><span class="bash">  60秒之后，且至少10000次变更</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 不写磁盘的话就把所有 <span class="string">&quot;save&quot;</span> 设置注释掉就行了。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 通过添加一条带空字符串参数的save指令也能移除之前所有配置的save指令，如: save <span class="string">&quot;&quot;</span></span></span><br><span class="line">save 900 1</span><br><span class="line">save 300 10</span><br><span class="line">save 60 10000</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下如果上面配置的RDB模式开启且最后一次的保存失败，redis 将停止接受写操作，让用户知道问题的发生。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果后台保存进程重新启动工作了，redis 也将自动的允许写操作。如果有其它监控方式也可关闭。</span></span><br><span class="line">stop-writes-on-bgsave-error yes</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 是否在备份.rdb文件时是否用LZF压缩字符串，默认设置为yes。如果想节约cpu资源可以把它设置为no。</span></span><br><span class="line">rdbcompression yes</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 因为版本5的RDB有一个CRC64算法的校验和放在了文件的末尾。这将使文件格式更加可靠,</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 但在生产和加载RDB文件时，这有一个性能消耗(大约10%)，可以关掉它来获取最好的性能。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 生成的关闭校验的RDB文件有一个0的校验和，它将告诉加载代码跳过检查rdbchecksum yes</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> rdb文件名称</span></span><br><span class="line">dbfilename dump.rdb</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 备份文件目录，文件名就是上面的 <span class="string">&quot;dbfilename&quot;</span> 的值。累加文件也放这里。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意你这里指定的必须是目录，不是文件名。</span></span><br><span class="line">dir /Users/wuji/redis_data/</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######################## 主从同步 #########################</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 主从同步配置。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1) redis主从同步是异步的，但是可以配置在没有指定slave连接的情况下使master停止写入数据。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2) 连接中断一定时间内，slave可以执行部分数据重新同步。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 3) 同步是自动的，slave可以自动重连且同步数据。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> slaveof &lt;masterip&gt; &lt;masterport&gt;</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> master连接密码</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> masterauth &lt;master-password&gt;</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 当一个slave失去和master的连接，或者同步正在进行中，slave的行为有两种可能：</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1) 如果 slave-serve-stale-data 设置为 <span class="string">&quot;yes&quot;</span> (默认值)，slave会继续响应客户端请求，可能是正常数据，也可能是还没获得值的空数据。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2) 如果 slave-serve-stale-data 设置为 <span class="string">&quot;no&quot;</span>，slave会回复<span class="string">&quot;正在从master同步（SYNC with master in progress）&quot;</span>来处理各种请求，除了 INFO 和 SLAVEOF 命令。</span></span><br><span class="line">slave-serve-stale-data yes</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 你可以配置salve实例是否接受写操作。可写的slave实例可能对存储临时数据比较有用(因为写入salve<span class="comment"># 的数据在同master同步之后将很容被删除)，但是如果客户端由于配置错误在写入时也可能产生一些问题。</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 从Redis2.6默认所有的slave为只读</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意:只读的slave不是为了暴露给互联网上不可信的客户端而设计的。它只是一个防止实例误用的保护层。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 一个只读的slave支持所有的管理命令比如config,debug等。为了限制你可以用<span class="string">&#x27;rename-command&#x27;</span>来隐藏所有的管理和危险命令来增强只读slave的安全性。</span></span><br><span class="line">slave-read-only yes</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 同步策略: 磁盘或socket，默认磁盘方式</span></span><br><span class="line">repl-diskless-sync no</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果非磁盘同步方式开启，可以配置同步延迟时间，以等待master产生子进程通过socket传输RDB数据给slave。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认值为5秒，设置为0秒则每次传输无延迟。</span></span><br><span class="line">repl-diskless-sync-delay 5</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> slave根据指定的时间间隔向master发送ping请求。默认10秒。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> repl-ping-slave-period 10</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 同步的超时时间</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1）slave在与master SYNC期间有大量数据传输，造成超时</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2）在slave角度，master超时，包括数据、ping等</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 3）在master角度，slave超时，当master发送REPLCONF ACK pings<span class="comment"># 确保这个值大于指定的repl-ping-slave-period，否则在主从间流量不高时每次都会检测到超时</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> repl-timeout 60</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 是否在slave套接字发送SYNC之后禁用 TCP_NODELAY</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果选择yes，Redis将使用更少的TCP包和带宽来向slaves发送数据。但是这将使数据传输到slave上有延迟，Linux内核的默认配置会达到40毫秒。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果选择no，数据传输到salve的延迟将会减少但要使用更多的带宽。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认我们会为低延迟做优化，但高流量情况或主从之间的跳数过多时，可以设置为“yes”。</span></span><br><span class="line">repl-disable-tcp-nodelay no</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置数据备份的backlog大小。backlog是一个slave在一段时间内断开连接时记录salve数据的缓冲，所以一个slave在重新连接时，不必要全量的同步，而是一个增量同步就足够了，将在断开连接的这段<span class="comment"># 时间内把slave丢失的部分数据传送给它。</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 同步的backlog越大，slave能够进行增量同步并且允许断开连接的时间就越长。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> backlog只分配一次并且至少需要一个slave连接。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> repl-backlog-size 1mb</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 当master在一段时间内不再与任何slave连接，backlog将会释放。以下选项配置了从最后一个</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> slave断开开始计时多少秒后，backlog缓冲将会释放。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 0表示永不释放backlog</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> repl-backlog-ttl 3600</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> slave的优先级是一个整数展示在Redis的Info输出中。如果master不再正常工作了，sentinel将用它来选择一个slave提升为master。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 优先级数字小的salve会优先考虑提升为master，所以例如有三个slave优先级分别为10，100，25，sentinel将挑选优先级最小数字为10的slave。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 0作为一个特殊的优先级，标识这个slave不能作为master，所以一个优先级为0的slave永远不会被<span class="comment"># sentinel挑选提升为master。</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认优先级为100</span></span><br><span class="line">slave-priority 100</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果master少于N个延时小于等于M秒的已连接slave，就可以停止接收写操作。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> N个slave需要是“oneline”状态。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 延时是以秒为单位，并且必须小于等于指定值，是从最后一个从slave接收到的ping（通常每秒发送）开始计数。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 该选项不保证N个slave正确同步写操作，但是限制数据丢失的窗口期。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 例如至少需要3个延时小于等于10秒的slave用下面的指令：</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> min-slaves-to-write 3</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> min-slaves-max-lag 10</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 两者之一设置为0将禁用这个功能。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认 min-slaves-to-write 值是0（该功能禁用）并且 min-slaves-max-lag 值是10。</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######################## 安全 #########################</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 要求客户端在处理任何命令时都要验证身份和密码。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> requirepass foobared</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 命令重命名</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在共享环境下，可以为危险命令改变名字。比如，你可以为 CONFIG 改个其他不太容易猜到的名字，这样内部的工具仍然可以使用。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 例如：</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 也可以通过改名为空字符串来完全禁用一个命令</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> rename-command CONFIG <span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 请注意：改变命令名字被记录到AOF文件或被传送到从服务器可能产生问题。</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######################## 限制 #########################</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置最多同时连接的客户端数量。默认这个限制是10000个客户端，然而如果Redis服务器不能配置</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 处理文件的限制数来满足指定的值，那么最大的客户端连接数就被设置成当前文件限制数减32（因为Redis服务器保留了一些文件描述符作为内部使用）</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 一旦达到这个限制，Redis会关闭所有新连接并发送错误<span class="string">&#x27;max number of clients reached&#x27;</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> maxclients 10000</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 不要使用比设置的上限更多的内存。一旦内存使用达到上限，Redis会根据选定的回收策略（参见：maxmemmory-policy）删除key。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果因为删除策略Redis无法删除key，或者策略设置为 <span class="string">&quot;noeviction&quot;</span>，Redis会回复需要更多内存的错误信息给命令。例如，SET,LPUSH等等，但是会继续响应像Get这样的只读命令。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在使用Redis作为LRU缓存，或者为实例设置了硬性内存限制的时候（使用 <span class="string">&quot;noeviction&quot;</span> 策略）</span></span><br><span class="line"><span class="meta">#</span><span class="bash">的时候，这个选项通常事很有用的。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 警告：当有多个slave连上达到内存上限时，master为同步slave的输出缓冲区所需内存不计算在使用内存中。这样当移除key时，就不会因网络问题 / 重新同步事件触发移除key的循环，反过来slaves的输出缓冲区充满了key被移除的DEL命令，这将触发删除更多的key，直到这个数据库完全被清空为止。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 总之，如果你需要附加多个slave，建议你设置一个稍小maxmemory限制，这样系统就会有空闲的内存作为slave的输出缓存区(但是如果最大内存策略设置为<span class="string">&quot;noeviction&quot;</span>的话就没必要了)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> maxmemory &lt;bytes&gt;</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 最大内存策略：如果达到内存限制了，Redis如何选择删除key。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> volatile-lru -&gt; 根据LRU算法删除设置过期时间的key</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> allkeys-lru -&gt; 根据LRU算法删除任何key</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> volatile-random -&gt; 随机移除设置过过期时间的key</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> allkeys-random -&gt; 随机移除任何key</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> volatile-ttl -&gt; 移除即将过期的key(minor TTL)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> noeviction -&gt; 不移除任何key，只返回一个写错误</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意：对所有策略来说，如果Redis找不到合适的可以删除的key都会在写操作时返回一个错误。<span class="comment"># 目前为止涉及的命令：set setnx setex append incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby getset mset msetnx exec sort</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认策略:</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> maxmemory-policy noeviction</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> LRU和最小TTL算法的实现都不是很精确，但是很接近（为了省内存），所以你可以用样本量做检测。 例如：默认Redis会检查3个key然后取最旧的那个，你可以通过下面的配置指令来设置样本的个数。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认值为5，数字越大结果越精确但是会消耗更多CPU。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> maxmemory-samples 5</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######################## APPEND ONLY MODE #########################</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下，Redis是异步的把数据导出到磁盘上。这种模式在很多应用里已经足够好，但Redis进程出问题或断电时可能造成一段时间的写操作丢失(这取决于配置的save指令)。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> AOF是一种提供了更可靠的替代持久化模式，例如使用默认的数据写入文件策略（参见后面的配置）。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 在遇到像服务器断电或单写情况下Redis自身进程出问题但操作系统仍正常运行等突发事件时，Redis能只丢失1秒的写操作。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> AOF和RDB持久化能同时启动并且不会有问题。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果AOF开启，那么在启动时Redis将加载AOF文件，它更能保证数据的可靠性。</span></span><br><span class="line">appendonly no</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> AOF文件名（默认：<span class="string">&quot;appendonly.aof&quot;</span>）</span></span><br><span class="line">appendfilename &quot;appendonly.aof&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> fsync() 系统调用告诉操作系统把数据写到磁盘上，而不是等更多的数据进入输出缓冲区。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 有些操作系统会真的把数据马上刷到磁盘上；有些则会尽快去尝试这么做。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Redis支持三种不同的模式：</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> no：不要立刻刷，只有在操作系统需要刷的时候再刷。比较快。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> always：每次写操作都立刻写入到aof文件。慢，但是最安全。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> everysec：每秒写一次。折中方案。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认的 <span class="string">&quot;everysec&quot;</span> 通常来说能在速度和数据安全性之间取得比较好的平衡。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> appendfsync always</span></span><br><span class="line">appendfsync everysec</span><br><span class="line"><span class="meta">#</span><span class="bash"> appendfsync no</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果AOF的同步策略设置成 <span class="string">&quot;always&quot;</span> 或者 <span class="string">&quot;everysec&quot;</span>，并且后台的存储进程（后台存储或写入AOF 日志）会产生很多磁盘I/O开销。某些Linux的配置下会使Redis因为 fsync()系统调用而阻塞很久。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 注意，目前对这个情况还没有完美修正，甚至不同线程的 fsync() 会阻塞我们同步的write(2)调用。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 为了缓解这个问题，可以用下面这个选项。它可以在 BGSAVE 或 BGREWRITEAOF 处理时阻止fsync()。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这就意味着如果有子进程在进行保存操作，那么Redis就处于<span class="string">&quot;不可同步&quot;</span>的状态。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这实际上是说，在最差的情况下可能会丢掉30秒钟的日志数据。（默认Linux设定）</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果把这个设置成<span class="string">&quot;yes&quot;</span>带来了延迟问题，就保持<span class="string">&quot;no&quot;</span>，这是保存持久数据的最安全的方式。</span></span><br><span class="line">no-appendfsync-on-rewrite no</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 自动重写AOF文件。如果AOF日志文件增大到指定百分比，Redis能够通过 BGREWRITEAOF 自动重写AOF日志文件。<span class="comment"># 工作原理：Redis记住上次重写时AOF文件的大小（如果重启后还没有写操作，就直接用启动时的AOF大小）</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这个基准大小和当前大小做比较。如果当前大小超过指定比例，就会触发重写操作。你还需要指定被重写日志的最小尺寸，这样避免了达到指定百分比但尺寸仍然很小的情况还要重写。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 指定百分比为0会禁用AOF自动重写特性。</span></span><br><span class="line">auto-aof-rewrite-percentage 100</span><br><span class="line">auto-aof-rewrite-min-size 64mb</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果设置为yes，如果一个因异常被截断的AOF文件被redis启动时加载进内存，redis将会发送日志通知用户。如果设置为no，erdis将会拒绝启动。此时需要用<span class="string">&quot;redis-check-aof&quot;</span>工具修复文件。</span></span><br><span class="line">aof-load-truncated yes</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######################## 集群 #########################</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 只有开启了以下选项，redis才能成为集群服务的一部分</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cluster-enabled yes</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 配置redis自动生成的集群配置文件名。确保同一系统中运行的各redis实例该配置文件不要重名。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cluster-config-file nodes-6379.conf</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 集群节点超时毫秒数。超时的节点将被视为不可用状态。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cluster-node-timeout 15000</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果数据太旧，集群中的不可用master的slave节点会避免成为备用master。如果slave和master失联时间超过:</span></span><br><span class="line"> (node-timeout * slave-validity-factor) + repl-ping-slave-period</span><br><span class="line">则不会被提升为master。</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如node-timeout为30秒，slave-validity-factor为10, 默认default repl-ping-slave-period为10秒,失联时间超过310秒slave就不会成为master。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 较大的slave-validity-factor值可能允许包含过旧数据的slave成为master，同时较小的值可能会阻止集群选举出新master。</span></span><br><span class="line"><span class="meta">#</span><span class="bash">为了达到最大限度的高可用性，可以设置为0，即slave不管和master失联多久都可以提升为master</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cluster-slave-validity-factor 10</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 只有在之前master有其它指定数量的工作状态下的slave节点时，slave节点才能提升为master。默认为1（即该集群至少有3个节点，1 master＋2 slaves，master宕机，仍有另外1个slave的情况下其中1个slave可以提升）</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 测试环境可设置为0，生成环境中至少设置为1</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cluster-migration-barrier 1</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认情况下如果redis集群如果检测到至少有1个<span class="built_in">hash</span> slot不可用，集群将停止查询数据。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果所有slot恢复则集群自动恢复。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果需要集群部分可用情况下仍可提供查询服务，设置为no。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> cluster-require-full-coverage yes</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"><span class="comment">######################## 慢查询日志 #########################</span></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 慢查询日志，记录超过多少微秒的查询命令。查询的执行时间不包括客户端的IO执行和网络通信时间，只是查询命令执行时间。</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1000000等于1秒，设置为0则记录所有命令</span></span><br><span class="line">slowlog-log-slower-than 10000</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 记录大小，可通过SLOWLOG RESET命令重置</span></span><br><span class="line">slowlog-max-len 128</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lkggithub.github.io/2019/07/18/RedisBloom/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lkg"/>
      <meta itemprop="description" content=""/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lkgBlog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/18/RedisBloom/" class="post-title-link" itemprop="url">RedisBloom 布隆过滤器</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-18 14:04:20" itemprop="dateCreated datePublished" datetime="2019-07-18T14:04:20+08:00">2019-07-18</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-03-06 14:39:57" itemprop="dateModified" datetime="2021-03-06T14:39:57+08:00">2021-03-06</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="RedisBloom-安装"><a href="#RedisBloom-安装" class="headerlink" title="RedisBloom 安装"></a>RedisBloom 安装</h1><p>参考：<a target="_blank" rel="noopener" href="https://oss.redislabs.com/redisbloom/">https://oss.redislabs.com/redisbloom/</a> </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> branch参数指定克隆的tag。</span></span><br><span class="line">git clone --branch v2.0.2 https://github.com/RedisBloom/RedisBloom.git </span><br><span class="line">cd RedisBloom</span><br><span class="line">make</span><br><span class="line"><span class="meta">#</span><span class="bash"> loadmodule 加载自定义module，也可以在redis.conf中</span></span><br><span class="line">src/redis-server --loadmodule .RedisBloom/redisbloom.so</span><br></pre></td></tr></table></figure>
<h1 id="RedisBloom命令"><a href="#RedisBloom命令" class="headerlink" title="RedisBloom命令"></a>RedisBloom命令</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 设置</span></span><br><span class="line">BF.RESERVE &#123;key&#125; &#123;error_rate&#125; &#123;capacity&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 添加</span></span><br><span class="line">BF.ADD &#123;key&#125; &#123;item&#125;</span><br><span class="line">BF.MADD &#123;key&#125; &#123;item&#125; [item...]</span><br><span class="line"><span class="meta">#</span><span class="bash"> 检验是否存在</span></span><br><span class="line">BF.EXISTS &#123;key&#125; &#123;item&#125;</span><br><span class="line">BF.MEXISTS &#123;key&#125; &#123;item&#125; [item...]</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lkggithub.github.io/2019/07/10/redis/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lkg"/>
      <meta itemprop="description" content=""/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lkgBlog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/10/redis/" class="post-title-link" itemprop="url">redis</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-10 10:31:12" itemprop="dateCreated datePublished" datetime="2019-07-10T10:31:12+08:00">2019-07-10</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-03-06 14:39:57" itemprop="dateModified" datetime="2021-03-06T14:39:57+08:00">2021-03-06</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 安装依赖</span></span><br><span class="line">sudo apt install make gcc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载安装</span></span><br><span class="line">wget http://download.redis.io/releases/redis-5.0.5.tar.gz</span><br><span class="line">tar xzf redis-5.0.5.tar.gz</span><br><span class="line">cd redis-5.0.5</span><br><span class="line">make MALLOC=libc</span><br><span class="line"><span class="meta">#</span><span class="bash"> 修改配置文件redis.conf，启动</span></span><br><span class="line">src/redis-server redis.conf</span><br></pre></td></tr></table></figure>

<h1 id="redis-cli-命令"><a href="#redis-cli-命令" class="headerlink" title="redis-cli 命令"></a>redis-cli 命令</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">auth Cnitsec%4321</span><br><span class="line"><span class="meta">#</span><span class="bash">取从位置0开始到位置2结束的3个元素。</span></span><br><span class="line">lrange mykey 0 2</span><br><span class="line">llen mykey</span><br></pre></td></tr></table></figure>

<h1 id="Redis-启动时出现警告的解决办法"><a href="#Redis-启动时出现警告的解决办法" class="headerlink" title="Redis 启动时出现警告的解决办法"></a>Redis 启动时出现警告的解决办法</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">7283:M 12 Mar 12:13:33.749 # WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</span><br><span class="line">7283:M 12 Mar 12:13:33.749 # Server started, Redis version 3.0.7</span><br><span class="line">7283:M 12 Mar 12:13:33.749 # WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add &#x27;vm.overcommit_memory = 1&#x27; to /etc/sysctl.conf and then reboot or run the command &#x27;sysctl vm.overcommit_memory=1&#x27; for this to take effect.</span><br><span class="line">7283:M 12 Mar 12:13:33.749 * The server is now ready to accept connections on port 6379</span><br></pre></td></tr></table></figure>

<h2 id="第1个警告-WARNING-The-TCP-backlog-setting-of-511-……-解决办法"><a href="#第1个警告-WARNING-The-TCP-backlog-setting-of-511-……-解决办法" class="headerlink" title="第1个警告(WARNING: The TCP backlog setting of 511 ……)解决办法"></a>第1个警告(WARNING: The TCP backlog setting of 511 ……)解决办法</h2><h3 id="方法1-临时设置生效"><a href="#方法1-临时设置生效" class="headerlink" title="方法1: 临时设置生效:"></a>方法1: 临时设置生效:</h3><blockquote>
<p>sysctl -w net.core.somaxconn = 1024</p>
</blockquote>
<h3 id="方法2-永久生效"><a href="#方法2-永久生效" class="headerlink" title="方法2: 永久生效:"></a>方法2: 永久生效:</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 修改/etc/sysctl.conf文件，增加一行</span></span><br><span class="line">net.core.somaxconn= 1024</span><br><span class="line"><span class="meta">#</span><span class="bash"> 然后执行命令</span></span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure>


<p>补充:<br>net.core.somaxconn是linux中的一个kernel参数，表示socket监听（listen）的backlog上限。<br>backlog是socket的监听队列，当一个请求（request）尚未被处理或建立时，他会进入backlog。<br>而socket server可以一次性处理backlog中的所有请求，处理后的请求不再位于监听队列中。<br>当server处理请求较慢，以至于监听队列被填满后，新来的请求会被拒绝。<br>所以说net.core.somaxconn限制了接收新 TCP 连接侦听队列的大小。<br>对于一个经常处理新连接的高负载 web服务环境来说，默认的 128 太小了。大多数环境这个值建议增加到 1024 或者更多。</p>
<h2 id="第2个警告-WARNING-overcommit-memory-is-set-to-0-……-同样也有两个解决办法"><a href="#第2个警告-WARNING-overcommit-memory-is-set-to-0-……-同样也有两个解决办法" class="headerlink" title="第2个警告(WARNING overcommit_memory is set to 0! ……)同样也有两个解决办法"></a>第2个警告(WARNING overcommit_memory is set to 0! ……)同样也有两个解决办法</h2><p>方法1: 临时设置生效: </p>
<blockquote>
<p>sysctl -w vm.overcommit_memory = 1</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 方法2: 永久生效: 修改/etc/sysctl.conf文件，增加一行</span></span><br><span class="line">vm.overcommit_memory = 1</span><br><span class="line"><span class="meta">#</span><span class="bash"> 然后执行命令</span></span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure>

<h3 id="补充"><a href="#补充" class="headerlink" title="补充:"></a>补充:</h3><p>overcommit_memory参数说明：<br>设置内存分配策略（可选，根据服务器的实际情况进行设置）<br>/proc/sys/vm/overcommit_memory<br>可选值：0、1、2。<br>0， 表示内核将检查是否有足够的可用内存供应用进程使用；如果有足够的可用内存，内存申请允许；否则，内存申请失败，并把错误返回给应用进程。<br>1， 表示内核允许分配所有的物理内存，而不管当前的内存状态如何。<br>2， 表示内核允许分配超过所有物理内存和交换空间总和的内存<br>注意：redis在dump数据的时候，会fork出一个子进程，理论上child进程所占用的内存和parent是一样的，比如parent占用的内存为8G，这个时候也要同样分配8G的内存给child,如果内存无法负担，往往会造成redis服务器的down机或者IO负载过高，效率下降。所以这里比较优化的内存分配策略应该设置为 1（表示内核允许分配所有的物理内存，而不管当前的内存状态如何）。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lkggithub.github.io/2019/07/10/window-mysql/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lkg"/>
      <meta itemprop="description" content=""/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lkgBlog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/07/10/window-mysql/" class="post-title-link" itemprop="url">windows zip包安装</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-07-10 10:26:12" itemprop="dateCreated datePublished" datetime="2019-07-10T10:26:12+08:00">2019-07-10</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-03-06 14:39:57" itemprop="dateModified" datetime="2021-03-06T14:39:57+08:00">2021-03-06</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="windows-zip包安装"><a href="#windows-zip包安装" class="headerlink" title="windows zip包安装"></a>windows zip包安装</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">.\mysqld.exe --initialize-insecure --user=mysql</span><br><span class="line"> .\mysqld.exe install</span><br><span class="line">net start mysql</span><br><span class="line">mysql -ruoo -p</span><br><span class="line">GRANT ALL PRIVILEGES ON *.* TO &#x27;root&#x27;@&#x27;%&#x27; IDENTIFIED BY &#x27;lkg123456&#x27; WITH GRANT OPTION;</span><br><span class="line">flush privileges;</span><br><span class="line"></span><br><span class="line">show variables like &#x27;%character%&#x27;;</span><br><span class="line"></span><br><span class="line">--defaults-file=&quot;C:\Software\mysql-5.7.23-winx64\my-default.ini&quot;</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> window 删除</span></span><br><span class="line">4》运行“regedit”文件，打开注册表。</span><br><span class="line">删除HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Eventlog\Application\MySQL文件夹</span><br><span class="line">删除HKEY_LOCAL_MACHINE\SYSTEM\ControlSet002\Services\Eventlog\Application\MySQL文件夹。</span><br><span class="line">删除HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application\MySQL的文件夹。</span><br><span class="line">如果没有相应的文件夹，就不用删除了。</span><br></pre></td></tr></table></figure>

<h2 id="my-default-ini样例"><a href="#my-default-ini样例" class="headerlink" title="my-default.ini样例"></a>my-default.ini样例</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">port=3306</span><br><span class="line">#这一句解决有IPV6协议的计算机上默认采用IPV6协议导致无法从程序连接数据库的问题</span><br><span class="line">bind-address=127.0.0.1</span><br><span class="line"># 允许最大连接数</span><br><span class="line">max_connections = 200</span><br><span class="line"># 服务端使用的字符集默认为8比特编码的latin1字符集</span><br><span class="line">character-set-server = utf8mb4</span><br><span class="line"># 创建新表时将使用的默认存储引擎</span><br><span class="line">default-storage-engine = INNODB</span><br><span class="line"></span><br><span class="line">[client]</span><br><span class="line"># 设置mysql客户端默认字符集</span><br><span class="line">default-character-set = utf8mb4</span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lkggithub.github.io/2019/05/31/BeautifulSoup/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lkg"/>
      <meta itemprop="description" content=""/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lkgBlog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/31/BeautifulSoup/" class="post-title-link" itemprop="url">BeautifulSoup</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-31 10:26:12" itemprop="dateCreated datePublished" datetime="2019-05-31T10:26:12+08:00">2019-05-31</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-03-06 14:39:57" itemprop="dateModified" datetime="2021-03-06T14:39:57+08:00">2021-03-06</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="对象的种类"><a href="#对象的种类" class="headerlink" title="对象的种类"></a>对象的种类</h1><p>Beautiful Soup将复杂HTML文档转换成一个复杂的树形结构,每个节点都是Python对象,所有对象可以归纳为4种: Tag , NavigableString , BeautifulSoup , Comment .</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lkggithub.github.io/2019/05/30/java%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lkg"/>
      <meta itemprop="description" content=""/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lkgBlog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/30/java%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6/" class="post-title-link" itemprop="url">java位运算符</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-30 22:23:48" itemprop="dateCreated datePublished" datetime="2019-05-30T22:23:48+08:00">2019-05-30</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-03-06 14:39:57" itemprop="dateModified" datetime="2021-03-06T14:39:57+08:00">2021-03-06</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/java%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">java基础</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>关于java中位运算符的使用和理解</p>
<h1 id="amp-（按位与）"><a href="#amp-（按位与）" class="headerlink" title="&amp;（按位与）"></a>&amp;（按位与）</h1><p>‘ &amp; ’ 符号的作用是对运算符的两侧以二进制表达的操作符按位进行‘与’运算。<br>规则：<br>只有两个操作数对应位同为1时，结果为1，其余全为0. （或者是只要有一个操作数为0，结果就为0）。</p>
<p>个人理解：在编程中，我们可以认为‘1’代表‘true’，‘0’代表‘false’。那么就可以理解为只有都为‘true’的时候才为‘true’，否则就是‘false’。</p>
<p>举例：<br>5 &amp; 10 = ?</p>
<p>10 的二进制为：1010</p>
<p>5 的二进制为：0101</p>
<p>则 5 &amp; 10 的二进制为 0000，完整的运算为 5 &amp; 10 = 0</p>
<p>int i = 12; i &amp;= 7; i = ?<br>‘ &amp;= ’ 的逻辑跟 ‘ += ’ 的处理逻辑是一样的<br>i &amp;= 7 可以看成 i = i &amp; 7<br>所以i = 4</p>
<h1 id="（按位或）"><a href="#（按位或）" class="headerlink" title="|（按位或）"></a>|（按位或）</h1><p>‘ | ’ 符号的作用是对运算符两侧以二进制表达的操作符按位分别进行’或’运算。<br>规则：<br>只有两个操作数对应位同为1时，结果为1，其余全为0. （或者是只要有一个操作数为1，结果就为1）。</p>
<p>个人理解：在编程中，我们可以认为‘1’代表‘true’，‘0’代表‘false’。那么就可以理解为只要有一个为‘true’的时候就为‘true’，否则就是‘false’。</p>
<p>举例：<br>5 | 10 = ?</p>
<p>10 的二进制为：1010</p>
<p>5 的二进制为：0101</p>
<p>则 5 | 10 的二进制为 1111，完整的运算为 5 | 10 = 15</p>
<p>int i = 12; i |= 7; i = ?<br>‘ |= ’ 的逻辑跟 ‘ += ’ 的处理逻辑是一样的<br>i |= 7 可以看成 i = i | 7<br>所以i = 15</p>
<h1 id="（按位异或）"><a href="#（按位异或）" class="headerlink" title="^（按位异或）"></a>^（按位异或）</h1><p>‘ ^ ’ 符号的作用是对运算符两侧以二进制表达的操作数按位分别进行’异或’运算。<br>规则：<br>仅当两个操作数不同一时候。对应的输出结果才为1，否则为0。</p>
<p>个人理解：在编程中，我们可以认为‘1’代表‘true’，‘0’代表‘false’。那么就可以理解为值不相等的时候为‘true’，值相等的时候为‘false’。</p>
<p>举例：<br>5 ^ 10 = ?</p>
<p>10 的二进制为：1010</p>
<p>5 的二进制为：0101</p>
<p>则 5 ^ 10 的二进制为 1111，完整的运算为 5 ^ 10 = 15</p>
<p>int i = 12; i ^= 7; i = ?<br>‘ ^= ’ 的逻辑跟 ‘ += ’ 的处理逻辑是一样的<br>i ^= 7 可以看成 i = i ^ 7<br>所以i = 11</p>
<h1 id="（按位非）"><a href="#（按位非）" class="headerlink" title="~（按位非）"></a>~（按位非）</h1><p>‘ ~ ’ 符号的作用是将各位数组取反。<br>规则：<br>全部的0变为1，1变为0。</p>
<p>个人理解：在编程中，我们可以认为‘1’代表‘true’，‘0’代表‘false’。那么就可以理解为将‘true’变成‘false’，而‘false’变为‘true’。</p>
<p>举例：<br>~ 10 = ?</p>
<p>10 的二进制为：1010</p>
<p>取反后为：1111 1111 1111 0101</p>
<p>则 1111 1111 1111 0101 的十进制为 -11，完整的运算为 ~ 10 = -11</p>
<p>很多人对负数的二进制的转换很迷惑，在这里为大家讲解下：<br>因为电脑的世界中只有 ‘ 1 ’ 和 ‘ 0 ’ ，所以在表示正负数的时候是从最高位看的，最高位如果为 ‘ 1 ’ 则为负数，如果是 ‘ 0 ’ 则是正数。<br>但是如果负数单纯是把最高位变为1的话，在运算中会出现不是我们想要的值。所以引入了：‘原码’，‘反码’，‘补码’。<br>正数的‘原码’，‘反码’，‘补码’都一样。<br>负数的‘反码’是对除了符号位（最高位）的‘原码’取反，而‘补码’是对‘反码’ + 1，而计算机所采用的就是‘补码’的方式。<br>示例：<br>-11的‘原码’是 ： 1000 0000 0000 1011<br>求出对应的反码 ： 1111 1111 1111 0100<br>求出对应的补码 ： 1111 1111 1111 0101<br>所以在计算机中 ‘ -11 ’ 对应的二进制为 ‘ 1111 1111 1111 0101 ’</p>
<h1 id="lt-lt-（左位移运算符）"><a href="#lt-lt-（左位移运算符）" class="headerlink" title="&lt;&lt;（左位移运算符）"></a>&lt;&lt;（左位移运算符）</h1><p>‘ &lt;&lt; ’ 符号的作用是将一个运算对象的各二进制位全部左移若干位。<br>规则：<br>左边的二进制位丢弃，右边补0。</p>
<p>个人理解：左移可以看成是乘以2的多少次方。3 &lt;&lt; 3就代表3乘以2的3次方。</p>
<p>举例：<br>10 &lt;&lt; 3 = ?</p>
<p>10 的二进制为：0000 0000 0000 1010</p>
<p>移位后为：0000 0000 0101 0000    （80）</p>
<p>则 10 &lt;&lt; 3 = 80</p>
<p>int i = 5; i &lt;&lt;= 4; i = ?<br>‘ &lt;&lt;= ’ 的逻辑跟 ‘ += ’ 的处理逻辑是一样的<br>i &lt;&lt;= 4 可以看成 i = i &lt;&lt; 4<br>所以i = 80</p>
<h1 id="gt-gt-（右位移运算符）"><a href="#gt-gt-（右位移运算符）" class="headerlink" title="&gt;&gt;（右位移运算符）"></a>&gt;&gt;（右位移运算符）</h1><p>‘ &gt;&gt; ’ 符号的作用是将一个运算对象的各二进制位全部右移若干位。<br>规则：<br>正数左补0，负数左补1，右边丢弃。</p>
<p>个人理解：正数右移可以看成是跟2的多少次方取模，10 &gt;&gt; 3就代表10跟8取模得1。而负数则需要对应的转换，因为负数进行了补码的操作，所以跟正数的逻辑不同</p>
<p>举例：<br>10 &gt;&gt; 3 = ?</p>
<p>10 的二进制为：0000 0000 0000 1010</p>
<p>移位后为：0000 0000 0000 0001</p>
<p>则 10 &gt;&gt; 3 = 1</p>
<p>int i = 5; i &gt;&gt;= 4; i = ?<br>‘ &gt;&gt;= ’ 的逻辑跟 ‘ += ’ 的处理逻辑是一样的<br>i &gt;&gt;= 4 可以看成 i = i &gt;&gt; 4<br>所以i = 0</p>
<h1 id="gt-gt-gt-（无符号右位移运算符）"><a href="#gt-gt-gt-（无符号右位移运算符）" class="headerlink" title="&gt;&gt;&gt;（无符号右位移运算符）"></a>&gt;&gt;&gt;（无符号右位移运算符）</h1><p>‘ &gt;&gt;&gt; ’ 符号的作用是将一个运算对象的各二进制位全部右移若干位。<br>规则：<br>右移后左边空出的位用零来填充。移出右边的位被丢弃。无符号的意思是将符号位当作数字位看待。</p>
<p>个人理解：正数的无符号右移可以看成是跟2的多少次方取模，10 &gt;&gt;&gt; 3就代表10跟8取模得1。而负数的无符号右移是不同的，就不需要再进行转换的操作，-1 &gt;&gt;&gt; 1 = 2147483647</p>
<p>举例：<br>10 &gt;&gt;&gt; 3 = ?</p>
<p>10 的二进制为：0000 0000 0000 1010</p>
<p>移位后为：0000 0000 0000 0001</p>
<p>则 10 &gt;&gt;&gt; 3 = 1</p>
<p>int i = 5; i &gt;&gt;&gt;= 4; i = ?<br>‘ &gt;&gt;&gt;= ’ 的逻辑跟 ‘ += ’ 的处理逻辑是一样的<br>i &gt;&gt;&gt;= 4 可以看成 i = i &gt;&gt;&gt; 4<br>所以i = 0</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://lkggithub.github.io/2019/05/29/unit/"/>

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="lkg"/>
      <meta itemprop="description" content=""/>
      <meta itemprop="image" content="/images/avatar.gif"/>
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lkgBlog"/>
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/05/29/unit/" class="post-title-link" itemprop="url">unit</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-05-29 14:22:12" itemprop="dateCreated datePublished" datetime="2019-05-29T14:22:12+08:00">2019-05-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2021-03-06 14:39:57" itemprop="dateModified" datetime="2021-03-06T14:39:57+08:00">2021-03-06</time>
              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="unit配置文件的区块"><a href="#unit配置文件的区块" class="headerlink" title="unit配置文件的区块"></a>unit配置文件的区块</h2><p><code>[Unit]</code>区块通常是配置文件的第一个区块，用来定义 Unit 的元数据，以及配置与其他 Unit 的关系。它的主要字段如下。</p>
<blockquote>
<ul>
<li><code>Description</code>：简短描述</li>
<li><code>Documentation</code>：文档地址</li>
<li><code>Requires</code>：当前 Unit 依赖的其他 Unit，如果它们没有运行，当前 Unit 会启动失败</li>
<li><code>Wants</code>：与当前 Unit 配合的其他 Unit，如果它们没有运行，当前 Unit 不会启动失败</li>
<li><code>BindsTo</code>：与<code>Requires</code>类似，它指定的 Unit 如果退出，会导致当前 Unit 停止运行</li>
<li><code>Before</code>：如果该字段指定的 Unit 也要启动，那么必须在当前 Unit 之后启动</li>
<li><code>After</code>：如果该字段指定的 Unit 也要启动，那么必须在当前 Unit 之前启动</li>
<li><code>Conflicts</code>：这里指定的 Unit 不能与当前 Unit 同时运行</li>
<li><code>Condition...</code>：当前 Unit 运行必须满足的条件，否则不会运行</li>
<li><code>Assert...</code>：当前 Unit 运行必须满足的条件，否则会报启动失败</li>
</ul>
</blockquote>
<p><code>[Install]</code>通常是配置文件的最后一个区块，用来定义如何启动，以及是否开机启动。它的主要字段如下。</p>
<blockquote>
<ul>
<li><code>WantedBy</code>：它的值是一个或多个 Target，当前 Unit 激活时（enable）符号链接会放入<code>/etc/systemd/system</code>目录下面以 Target 名 + <code>.wants</code>后缀构成的子目录中</li>
<li><code>RequiredBy</code>：它的值是一个或多个 Target，当前 Unit 激活时，符号链接会放入<code>/etc/systemd/system</code>目录下面以 Target 名 + <code>.required</code>后缀构成的子目录中</li>
<li><code>Alias</code>：当前 Unit 可用于启动的别名</li>
<li><code>Also</code>：当前 Unit 激活（enable）时，会被同时激活的其他 Unit</li>
</ul>
</blockquote>
<p><code>[Service]</code>区块用来 Service 的配置，只有 Service 类型的 Unit 才有这个区块。它的主要字段如下。</p>
<blockquote>
<ul>
<li><code>Type</code>：定义启动时的进程行为。它有以下几种值。</li>
<li><code>Type=simple</code>：默认值，执行<code>ExecStart</code>指定的命令，启动主进程</li>
<li><code>Type=forking</code>：以 fork 方式从父进程创建子进程，创建后父进程会立即退出</li>
<li><code>Type=oneshot</code>：一次性进程，Systemd 会等当前服务退出，再继续往下执行</li>
<li><code>Type=dbus</code>：当前服务通过D-Bus启动</li>
<li><code>Type=notify</code>：当前服务启动完毕，会通知<code>Systemd</code>，再继续往下执行</li>
<li><code>Type=idle</code>：若有其他任务执行完毕，当前服务才会运行</li>
<li><code>ExecStart</code>：启动当前服务的命令</li>
<li><code>ExecStartPre</code>：启动当前服务之前执行的命令</li>
<li><code>ExecStartPost</code>：启动当前服务之后执行的命令</li>
<li><code>ExecReload</code>：重启当前服务时执行的命令</li>
<li><code>ExecStop</code>：停止当前服务时执行的命令</li>
<li><code>ExecStopPost</code>：停止当其服务之后执行的命令</li>
<li><code>RestartSec</code>：自动重启当前服务间隔的秒数</li>
<li><code>Restart</code>：定义何种情况 Systemd 会自动重启当前服务，可能的值包括<code>always</code>（总是重启）、<code>on-success</code>、<code>on-failure</code>、<code>on-abnormal</code>、<code>on-abort</code>、<code>on-watchdog</code></li>
<li><code>TimeoutSec</code>：定义 Systemd 停止当前服务之前等待的秒数</li>
<li><code>Environment</code>：指定环境变量</li>
</ul>
</blockquote>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot; aria-label&#x3D;&quot;下一页&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">lkg</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/%20%7C%7C%20archive">
                
                    <span class="site-state-item-count">14</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/%20%7C%7C%20th">
                    
                  
                    
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">2</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/%20%7C%7C%20tags">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">9</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/lkgGitHub" title="GitHub &rarr; https://github.com/lkgGitHub" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://blog.csdn.net/lkgCSDN" title="CSDN &rarr; https://blog.csdn.net/lkgCSDN" rel="noopener" target="_blank"><i class="fa fa-fw fa-CSDN"></i>CSDN</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://www.cnblogs.com/lkgBlogs" title="博客园 &rarr; https://www.cnblogs.com/lkgBlogs" rel="noopener" target="_blank"><i class="fa fa-fw fa-博客园"></i>博客园</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="/627861816@qq.com" title="E-Mail &rarr; 627861816@qq.com"><i class="fa fa-fw fa-E-Mail"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lkg</span>

  

  
</div>



        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.1"></script>

  <script src="/js/motion.js?v=7.1.1"></script>



  
  


  <script src="/js/affix.js?v=7.1.1"></script>

  <script src="/js/schemes/pisces.js?v=7.1.1"></script>



  

  


  <script src="/js/next-boot.js?v=7.1.1"></script>


  

  

  

  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
